#!/usr/bin/env node --harmony
'use strict';
var Clala = require('../index.js');
var fs = require('fs');

var file = process.argv[2];
var client = new Clala.Client();

if (!file) {
  client.repl();
} else {
  fs.readFile(file, 'utf8', function (err, text) {
    if (err) { throw err }

    var parsed = client.parse(text);

    if (!(parsed instanceof Array)) {
      parsed = [parsed];
    }

    for (var i = 0; i < parsed.length; i++) {
      Clala.evaluate(parsed[i], client.global_env);
    }
  });
}
